{"componentChunkName":"component---src-templates-blog-post-js","path":"/react-dynamically-update-searchparams-and-URL/","result":{"data":{"site":{"siteMetadata":{"title":"Stefi's Shorts","author":"Stefi Rosca"}},"markdownRemark":{"html":"<p>The SkiBuddies app is a web app one which one can search for skiers and snowboarders with a few filters. When doing this search I wanted the data to be shown in the URL which meant I needed to find a way to update the URL search parameters dynamically.</p>\n<p>The URL search parameters are everything that would come after a ? </p>\n<p>Like for example in this URL: <a href=\"http://localhost:3000/?sport=ski&#x26;level=medium\">http://localhost:3000/?sport=ski&#x26;level=medium</a></p>\n<p>Why did I want this? For example if someone would share the URL above I want the filters to stay set. If they would not be bound to the data it wouldn’t work. (this check I'm not talking about in this article)</p>\n<p>In order to do this I used two hooks from the <a style=\"color: #942874; text-decoration:underline\" target=\"blank\" href=\"https://reactrouter.com/web/guides/quick-starty\">React Router.</a> (The React Router was used to handle all the routing in the app): <strong>useLocation()</strong> and <strong>useHistory()</strong></p>\n<ul>\n<li>useLocation returns the exact location you are at and the object includes besides the pathname and other information also the search params, which we need.</li>\n<li>useHistory is a hook that gives us access to the history instance, which we will use to navigate. It come with some methods that come in handy when working with URLs.</li>\n</ul>\n<p>So how do we put it all together? </p>\n<p>We import from react-router-dom (which I have installed) the location and history hooks.</p>\n <pre class=\"line-numbers\" style=\"max-width=300px; width: 80%; background: #352d39; color:#e3f4f5; font-family: Open Sans,sans-serif\">\n<code class=\"language-javascript\" style=\"max-width:100vw\">\n import { useLocation, useHistory } from  \"react-router-dom\"\n \n let location = useLocation();\n let history = useHistory();\n \n</code></pre>\n<p>Next I will use the <a style=\"color: #942874; text-decoration:underline\" target=\"blank\" href=\"https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams\">URLSearchParams</a> which is a Web API. By creating grabbing the URLSearchParams we will get an object that includes methods that allow us to work with the query string of a URL. </p>\n<p>In my app I create a const in which I will save these search params. If you remember these are stored in the location under search. Location, the hook that we have access to inside the router. </p>\n<pre class=\"line-numbers\" style=\"max-width=300px; width: 80%; background: #352d39; color:#e3f4f5; font-family: Open Sans,sans-serif\">\n<code class=\"language-javascript\" style=\"max-width:100vw\">\n const parameters = new URLSearchParams(location.search);\n\n</code></pre>\n<p>The <strong>URLSearchParams.get()</strong> method will returns the first value associated with the given search parameter.</p>\n<p>If I would do: </p>\n<pre class=\"line-numbers\" style=\"max-width=300px; width: 80%; background: #352d39; color:#e3f4f5; font-family: Open Sans,sans-serif\">\n<code class=\"language-javascript\" style=\"max-width:100vw\">\n const sportFilter = parameters.get('sport'); \n\n</code></pre>\n<p>For the following URL <a href=\"http://localhost:3000/?sport=ski&#x26;level=medium\">http://localhost:3000/?sport=ski&#x26;level=medium</a>    </p>\n<p>=> sportFilter will be equal to ‘ski’.</p>\n<p>If we would want to get the level as well, we use again the get method from the URLSearchParams.\nconst levelFilter = parameters.get(‘level’);\nIn this case levelFilter will be equal to medium. </p>\n<p>Now what do we do with this information? We can pass this information to the variables I have already declared in my React functional component, sport and level, that change these filters. </p>\n<p>I would do this when the component mounts and when the location changes. </p>\n<pre class=\"line-numbers\" style=\"max-width=300px; width: 80%; background: #352d39; color:#e3f4f5; font-family: Open Sans,sans-serif\">\n<code class=\"language-javascript\" style=\"max-width:100vw\">\n const [sport, setSport] = useState(\"\")\n const [level, setLevel] = useState(\"\") \n\n   useEffect(() => {\n \n    const parameters = new URLSearchParams(location.search);\n    const sportFilter = parameters.get('sport');\n    const levelFilter = parameters.get('level');\n       if (sportFilter) {\n           setSport(sportFilter)\n       }\n       if (levelFilter) {\n           setLevel(levelFilter)\n       }\n\n   }, [location]);\n\n</code></pre>\n<p>What will happen now is that if I pass the URL as you see in the screenshot below we would make the selection happen. This means that I could share this URL with someone and it will open the exact same page. </p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 590px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/blog/static/e4ff0d176b68df15ec556c13403a6383/51dd6/url-demo.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 37.83783783783784%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAICAYAAAD5nd/tAAAACXBIWXMAABYlAAAWJQFJUiTwAAABfUlEQVQoz4VSS27bMBTUrfNZt4fIBdp0VweNgy6aCwRJbBdoNkXjWLYsyxQli39S0vSRRtBkVUKDeRxxhk+kMqUNtjuG1bogrrCrWEKsS+JqX6OT6v8QCu1BILv48Rsfvv7Cx8kTzr78xPkbxPnZ5QInn2eEOU7fIM5PPs3eaaeXc2S3iwJXdyt8u88xIb66yxMmSVtj+rDB98UON/My1a/azWyb9Olj1Da4Jm36WCB7XjNsSg6j7TtoZYBxRBwHzjA4k+qx74/sHQ71HsfJgNeRLfMdVgVD3SqwRh5BdcUllPHQAVguV3SeHI6yOmkTb/cN/jy/QHlAag9DonIDMsZbbMsKkjqyLsBYT+zJqFOgMgGss+hMj9CPZHbJzIVFLRysH6Bt9PUpOHvJS+RFhabTaA7/EDtuhUHTCijazNFmPX1Zpyw4aVJoDMMIelJgG/0N3XLFOFjN4UMP50OCDyF1LOksJf0SQlJNQWFA6lApnd6TJWkxUNFaQWv/AlskTjVVb5PLAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Screenshot demo url\"\n        title=\"Screenshot demo url\"\n        src=\"/blog/static/e4ff0d176b68df15ec556c13403a6383/fcda8/url-demo.png\"\n        srcset=\"/blog/static/e4ff0d176b68df15ec556c13403a6383/12f09/url-demo.png 148w,\n/blog/static/e4ff0d176b68df15ec556c13403a6383/e4a3f/url-demo.png 295w,\n/blog/static/e4ff0d176b68df15ec556c13403a6383/fcda8/url-demo.png 590w,\n/blog/static/e4ff0d176b68df15ec556c13403a6383/efc66/url-demo.png 885w,\n/blog/static/e4ff0d176b68df15ec556c13403a6383/c83ae/url-demo.png 1180w,\n/blog/static/e4ff0d176b68df15ec556c13403a6383/51dd6/url-demo.png 1952w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>What is left now is to update the URL also when the filters are changed via the web-app. We will call the useEffect this time when the when the level or sport variables change. </p>\n<p>Additionally we will use the <strong>history.push method</strong> to update the URL. Basically we push something in the URL which we see up in our browser.  </p>\n<p>All the search query parameters I’ve add  in an object which I now have to turn into query string parameters. Luckily <a style=\"color: #942874; text-decoration:underline\" target=\"blank\" href=\"https://howchoo.com/javascript/how-to-turn-an-object-into-query-string-parameters-in-javascript\">someone</a> already had done this before. What I need is to concatinate all the search params with it's corresponding value a with a “&#x26;” sign. You see this when I declare the queryString which I afterwards push to the history.</p>\n<p>One could also use library such as <a style=\"color: #942874; text-decoration:underline\" target=\"blank\" href=\"https://github.com/sindresorhus/query-string\">query-string</a>.</p>\n<pre class=\"line-numbers\" style=\"max-width=300px; width: 80%; background: #352d39; color:#e3f4f5; font-family: Open Sans,sans-serif\">\n<code class=\"language-javascript\" style=\"max-width:100vw\">\n    useEffect(() => {\n      \n    const searchQuery = {\n           sport,\n           resort\n       }\n       const queryString = Object.keys(searchQuery).filter(key =>     \n       searchQuery[key]).map(key => key + '=' + searchQuery[key]).join('&');\n \n       history.push(`/?${queryString}`);\n\n   }, [sport, level]) \n\n</code></pre>\n<p>I hope this was useful to someone. The code for the whole thing can be found here in my Search component. <a href=\"https://github.com/stefi23/ski-with-me/blob/master/client/src/components/Search.js\">https://github.com/stefi23/ski-with-me/blob/master/client/src/components/Search.js</a></p>\n<p>Cheers!</p>","frontmatter":{"title":"React Router how to dynamically updated search parameters of an URL","date":"January 10, 2021","featuredImage":{"childImageSharp":{"sizes":{"src":"/blog/static/e4ff0d176b68df15ec556c13403a6383/2a4de/url-demo.png"}}}},"excerpt":"The SkiBuddies app is a web app one which one can search for skiers and snowboarders with a few filters. When doing this search I wanted the…","fields":{"slug":"/react-dynamically-update-searchparams-and-URL/"}}},"pageContext":{}}}